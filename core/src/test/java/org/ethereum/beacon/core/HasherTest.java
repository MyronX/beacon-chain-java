package org.ethereum.beacon.core;

import org.ethereum.beacon.consensus.hasher.SSZObjectHasher;
import org.ethereum.beacon.core.operations.attestation.AttestationData;
import org.ethereum.beacon.core.spec.SpecConstants;
import org.ethereum.beacon.core.spec.SpecConstantsResolver;
import org.ethereum.beacon.core.state.BeaconStateImpl;
import org.ethereum.beacon.core.state.PendingAttestation;
import org.ethereum.beacon.core.types.Bitfield;
import org.ethereum.beacon.core.types.EpochNumber;
import org.ethereum.beacon.core.types.ShardNumber;
import org.ethereum.beacon.core.types.SlotNumber;
import org.ethereum.beacon.core.types.ValidatorIndex;
import org.ethereum.beacon.crypto.Hashes;
import org.ethereum.beacon.ssz.SSZBuilder;
import org.ethereum.beacon.ssz.SSZSerializer;
import org.ethereum.beacon.ssz.access.list.ReadListAccessor;
import org.junit.Test;
import tech.pegasys.artemis.ethereum.core.Hash32;
import tech.pegasys.artemis.util.bytes.BytesValue;

import static org.junit.Assert.assertEquals;

public class HasherTest {

  private final String state = "0x0b0000000000000000000000000000000000000000000000000000000000000058280000984600000000000000000000000000000000000000000000000000000000000000000000ecd8c54098532efb8cee62ab7b396ca06404d62b7da2519113200d3e9e58e72f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
      "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
      "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
      "000000000000000000000000000000000098480000984800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
      "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
      "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000cf7bbca4dd6d846b48aad7c31f25e08c59e92260d0d0b2e3dc0d452ff4177c10cf7bbca4dd6d846b48aad7c31f25e08c59e92260d0d0b2e3dc0d452ff4177c10cf7bbca4dd6d846b48aad7c31f25e08c59e92260d0d0b2e3dc0d452ff4177c100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
      "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
      "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
      "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f9407e7c5d37f9a616fee3284c4a05412722a1dc0af7b37dc0a7ef929f01ad30df25f94b7b31db79b7c6110d47bb5cb041a07b8ba3dc260ddaea345419714f881b6919c4d7c1c6b0b074db76830f8d8e183f0fd611c15f0cbe120645238e70ca000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
      "000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
      "0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000067db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25df" +
      "f5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48" +
      "cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b7" +
      "7945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f967db416b36b77945cbf696e48cbe551ded25dff5a1245af41d8f47e6a38566f9000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000" +
      "00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000b00000000000000cf7bbca4dd6d846b48aad7c31f25e08c59e92260d0d0b2e3dc0d452ff4177c100000000000000000000000000000000000000000000000000000000000000000258447227080f6d899aa8f692020a26b01025e7111c531d08e1b4cdf2f2241060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009848000042424242424242424242424242424242424242424242424242424242424242424000000000000000000000000000000000000000000000000000000000000000000000000000000098480000400000000000000097f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bb00cf478a431837728dcec3461f4f53b8749cdc4e03496dcaed459dea82b82eb800000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000" +
      "a572cbea904d67468808c8eb50a9450c9721db309128012543902d0ac358a62ae28f75bb8f1c7c42c39a8c5529bf0f4e00cf45213dd7b4716864d378f3c6d861467987e4d94b7f79a1f814a697e3863700000000000000000000000000000000ffffffffffffffffffffffffffffffff00004059730700000089ece308f9d1f0131765212deca99697b112d61f9be9a5f1f3780a51335b3ff981747a0b2ca2179b96d2c0c9024e52240024f67d20460d95ce9a161884e57401791e2bc921dcdd69d8af916befd8b6dd00000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000ac9b60d5afcbd5663a8a44b7c5a02f19e9a77ab0a35bd65809bb5c67ec582c897feb04decc694b13e08587f3ff9b5b6000842cef589da28d85b18f7655b70bd2e6d49dd682fb50f75c44293e9de9897a00000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000b0e7791fb972fe014159aa33a98622da3cdc98ff707965e536d8636b5fcc5ac7a91a8c46e59a00dca575af0f18fb13dc00cdcb18824446fa3041b29d7d3b5abc4152b417cb6814d7fd1852fa2511a64e00000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000a6e82f6da4520f85c5d27d8f329eccfa05944fd1096b20734c894966d12a9e2a9a9744529d7212d33883113a0cadb90900fc53a4f0ef2d7f9d7c44b243020f0ade637c6ec8b746e6e9faadbb23f70dd800000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000b928f3beb93519eecf0145da903b40a4c97dca00b21f12ac0df3be9116ef2ef27b2ae6bcd4c5bc2d54ef5a70627efcb70085dbd6412c68c516913d8bcca243ac18c2645d93c2efe48c3f66ebc93e96f80000000000000000000000000" +
      "0000000ffffffffffffffffffffffffffffffff000040597307000000a85ae765588126f5e860d019c0e26235f567a9c0c0b2d8ff30f3e8d436b1082596e5e7462d20f5be3764fd473e57f9cf007d495df81e296c181e43f1c2ff454a14a70c85ad4ad817383e953ed7d4e9c300000000000000000000000000000000ffffffffffffffffffffffffffffffff00004059730700000099cdf3807146e68e041314ca93e1fee0991224ec2a74beb2866816fd0826ce7b6263ee31e953a86d1b72cc2215a57793008de7f94cbdaa3586991d32efacc8c2a0c8359147d9d0fad19878ef6df7027100000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000af81da25ecf1c84b577fefbedd61077a81dc43b00304015b2b596ab67f00e41c86bb00ebd0f90d4b125eb0539891aeed00ba957005cf8bf493805c7bd247d635fddbd11a75850451e57b16179dcf37e600000000000000000000000000000000ffffffffffffffffffffffffffffffff00004059730700000080fd75ebcc0a21649e3177bcce15426da0e4f25d6828fbf4038d4d7ed3bd4421de3ef61d70f794687b12b2d571971a550005c96f7593a8cee8dab8453843aa8c48fb71edac04ead9e82d2ef06466a68a00000000000000000000000000000000ffffffffffffffffffffffffffffffff0000405973070000008345dd80ffef0eaec8920e39ebb7f5e9ae9c1d6179e9129b705923df7830c67f3690cbc48649d4079eadf5397339580c0096b76cf91060765f82fab1726b885dd31f7e5802a85448959652ecb8be290f00000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000851f8a0b82a6d86202a61cbc3b0f3db7d19650b914587bde4715ccd372e1e40cab95517779d840416e1679c84a6db24e0093bdcfee807eba41b7f610f4b045d4" +
      "8e594e4c45218b7281d0431cbab2bf9e00000000000000000000000000000000ffffffffffffffffffffffffffffffff00004059730700000099bef05aaba1ea467fcbc9c420f5e3153c9d2b5f9bf2c7e2e7f6946f854043627b45b008607b9a9108bb96f3c1c089d30024d7dcf5bfdb268e9f21b8eaafa60b4bcc9239dc1e3d328ea26ef33e67ed4200000000000000000000000000000000ffffffffffffffffffffffffffffffff0000405973070000008d9e19b3f4c7c233a6112e5397309f9812a4f61f754f11dd3dcb8b07d55a7b1dfea65f19a1488a14fef9a414950835820082f69735880f25f58253342432b447ffae46b504d00b89ad027a7e4fcdb1d400000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000a73eb991aa22cdb794da6fcde55a427f0a4df5a4a70de23a988b5e5fc8c4d844f66d990273267a54dd21579b7ba6a0860064f9d1e3fbd10f4e2cb4271682f3be4c387e37e5bedde2a0ea000dbe54c0a700000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000b098f178f84fc753a76bb63709e9be91eec3ff5f7f3a5f4836f34fe8a1a6d6c5578d8fd820573cef3a01e2bfef3eaf3a0038273f797a8b84c2fc4b4c3df88c0104f95e8e574c0be04ff564778116d91900000000000000000000000000000000ffffffffffffffffffffffffffffffff0000405973070000009252a4ac3529f8b2b6e8189b95a60b8865f07f9a9b73f98d5df708511d3f68632c4c7d1e2b03e6b1d1e2c01839752ada00bb11483da5e78e90f6689fbd1ba24d0a870f53bf8df2882aa18c120f8a0b4c00000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000b271205227c7aa27f45f20b3ba380dfea8b51efae91fd32e552774c99e2a1237aa59c0c" +
      "43f52aad99bba3783ea2f36a40023d5105a098d1eddc1f92cb23da74580adad77f211e7a62ab0072b00eb54bc00000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000a272e9d1d50a4aea7d8f0583948090d0888be5777f2846800b8281139cd4aa9eee05f89b069857a3e77ccfaae1615f9c00e93135d63dfbfa29cf30859850b2bb41f5afddec94571578dc5f95f40fe63700000000000000000000000000000000ffffffffffffffffffffffffffffffff0000405973070000009780e853f8ce7eda772c6691d25e220ca1d2ab0db51a7824b700620f7ac94c06639e91c98bb6abd78128f0ec845df8ef00e8c07d58904130100d35197d4ebd5d419735e1865cb683c43164f1da10e78400000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000ab48aa2cc6f4a0bb63b5d67be54ac3aed10326dda304c5aeb9e942b40d6e7610478377680ab90e092ef1895e62786008001778621db283b4a1a51d79337965a096920ff318ea303e67d8aec692f84d1700000000000000000000000000000000ffffffffffffffffffffffffffffffff0000405973070000008c8b694b04d98a749a0763c72fc020ef61b2bb3f63ebb182cb2e568f6a8b9ca3ae013ae78317599e7e7ba2a528ec754a00570820693660e8c91ed3e780ace652e2f310706ba6621fdeb0287f5f1a6af500000000000000000000000000000000ffffffffffffffffffffffffffffffff0000405973070000009717182463fbe215168e6762abcbb55c5c65290f2b5a2af616f8a6f50d625b46164178a11622d21913efdfa4b800648d00e03a76be6e456d9e35ce8660450d19cdbf26e8330db89344d159f1a9290a5e00000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000acb58c81ae0cae" +
      "2e9d4d446b730922239923c345744eee58efaadb36e9a0925545b18a987acf0bad469035b291e3726900a72d3077b4b691595aed3873f37f7bbd3a2639bde398796afe57c90b90e89e00000000000000000000000000000000ffffffffffffffffffffffffffffffff00004059730700000081ccc19e3b938ec2405099e90022a4218baa5082a3ca0974b24be0bc8b07e5fffaed64bef0d02c4dbfb6a307829afc5c00bbeaa657be675cd4362bb986f402ce1aabd3f0774bf68f8c6a408f70214ce200000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000ab83dfefb120fab7665a607d749ef1765fbb3cc0ba5827a20a135402c09d987c701ddb5b60f0f5495026817e8ab6ea2e00c5d350b2030825c9fbb1a9f9472b1ff31243f15aba062bfc16b3043c804a0200000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000b6ad11e5d15f77c1143b1697344911b9c590110fdd8dd09df2e58bfd757269169deefe8be3544d4e049fb3776fb0bcfb0005dc829ac041b5fc6113b698424015b3025977fe7f82c335aab95576be84d200000000000000000000000000000000ffffffffffffffffffffffffffffffff0000405973070000008515e7f61ca0470e165a44d247a23f17f24bf6e37185467bedb7981c1003ea70bbec875703f793dd8d11e56afa7f74ba003d35f781b38ae996e5b4bf53ae5020f78a0635ffa54a7f8d0cbe373f57677a00000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000ad84464b3966ec5bede84aa487facfca7823af383715078da03b387cc2f5d5597cdd7d025aa07db00a38b953bdeb6e3f00be66682352e7306dd4d3affcee9ae6331f322984252c808ba072ac35d957b800000000000000000000000000000000fffffff" +
      "fffffffffffffffffffffffff000040597307000000b29043a7273d0a2dbc2b747dcf6a5eccbd7ccb44b2d72e985537b117929bc3fd3a99001481327788ad040b4077c47c0d009dfc33db4b4d3baffbcf9ca7bc107b6f88132b479f9a90f894477dcb10761800000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000a72841987e4f219d54f2b6a9eac5fe6e78704644753c3579e776a3691bc123743f8c63770ed0f72a71e9e964dbf58f43001d4fc5c41d73926ee92d971b3a74e742aae346fe535f8170b47c857954fe4d00000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000aed3e9f4bb4553952b687ba7bcac3a5324f0cceecc83458dcb45d73073fb20cef4f9f0c64558a527ec26bad9a42e6c4c00799ab441ac454ba9f56a20e2c7f9dbbcb7ee6dff57b462a98e8d53da857f8f00000000000000000000000000000000ffffffffffffffffffffffffffffffff0000405973070000009446407bcd8e5efe9f2ac0efbfa9e07d136e68b03c5ebc5bde43db3b94773de8605c30419eb2596513707e4e7448bb50004ee076d9274ac65de5b3078c2d022f4a3de1843eb1db2f1dad5ceb5288ebba00000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000a60d5589316a5e16e1d9bb03db45136afb9a3d6e97d350256129ee32a8e33396907dc44d2211762967d88d3e2840f71b009692ba6374b20cc089d452fb72d8a06b627085561b7f9ff3500022de7defb500000000000000000000000000000000ffffffffffffffffffffffffffffffff00004059730700000090c0c1f774e77d9fad044aa06009a15e33941477b4b9a79fa43f327608a0a54524b3fcef0a896cb0df790e9995b6ebf100dbabd3b3fe7ae9b860aa08cd609454b1860816e593a4" +
      "e1722525614a3a2b6600000000000000000000000000000000ffffffffffffffffffffffffffffffff0000405973070000008f207bd83dad262dd9de867748094f7141dade78704eca74a71fd9cfc9136b5278d934db83f4f3908d7a3de84d583fc900d909542d8bee416b8b6899cb362b10c918f48f612b3901bc612f880714988800000000000000000000000000000000ffffffffffffffffffffffffffffffff00004059730700000082d333a47c24d4958e5b07be4abe85234c5ad1b685719a1f02131a612022ce0c726e58d52a53cf80b4a8afb21667dee100ff552950a427657e62aa5d08a38f2915a9f8f8e4c336c77d71216ec91bc13100000000000000000000000000000000ffffffffffffffffffffffffffffffff0000405973070000008e04ad5641cc0c949935785184c0b0237977e2282742bc0f81e58a7aa9bfee694027b60de0db0de0539a63d72fd57760001fdb46e9b1965b3b8e68b25c06d250149b94e152b67251455922e720b9d21f00000000000000000000000000000000ffffffffffffffffffffffffffffffff00004059730700000096413b2d61a9fc6a545b40e5c2e0064c53418f491a25994f270af1b79c59d5cf21d2e8c58785a8df09e7265ac975cb28001e29063e92931de2cc8c288f448c5acdf33fdc2989c6b36101d41115edf3cd00000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000ae5163dc807af48bc827d2fd86b7c37de5a364d0d504c2c29a1b0a243601016b21c0fda5d0a446b9cb2a333f0c08ab2000b3798635f121d30a79cd2b97d0bd4ef56ff10b22d54a104f0b44ebdb357bc100000000000000000000000000000000ffffffffffffffffffffffffffffffff0000405973070000008ce3b57b791798433fd323753489cac9bca43b98deaafaed91f4cb010730ae1e38b186ccd37a09b8aed62" +
      "ce23b699c4800bbf98005db90793912bb91aa9331ea0997df2365b16b8e9b065a176d31ebd100000000000000000000000000000000ffffffffffffffffffffffffffffffff0000405973070000008f81b19ee2e4d4d0ff6384c63bacb785bc05c4fc22e6f553079cc4ff7e0270d458951533458a01d160b22d59a8bd9ab5001d569a5f357d406aa7f9e50c3a0583528daf4b4892aad3818242a7d4885fd400000000000000000000000000000000ffffffffffffffffffffffffffffffff00004059730700000095fa3538b8379ff2423656ab436df1632b74311aaef49bc9a3cbd70b1b01febaf2f869b4127d0e8e6d18d7d919f1f6d80008d1aebc9c4b5f9cdaa0cb2f2624060c2a3edbf2f5e41fe343b07d94c4f69200000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000a65a82f7b291d33e28dd59d614657ac5871c3c60d1fb89c41dd873e41c30e0a7bc8d57b91fe50a4c96490ebf5769cb6b00b3c3f0e42f853d147b01bcaff36a0e53dcd697f5c838145d94684faee50f5100000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000b2a3cedd685176071a98ab100494628c989d65e4578eec9c5919f2c0321c3fc3f573b71ef81a76501d88ed9ed6c68e1300a3464e9c50888a32881d86923680d96184f76bfab0d777e3f8d3f463c25f2d00000000000000000000000000000000ffffffffffffffffffffffffffffffff0000405973070000008fc502abb5d8bdd747f8faf599b0f62b1c41145d30ee3b6ff1e52f9370240758eac4fdb6d7fb45ed258a43edebf63e960066fa818df8bb8306b594857394b7303c21e794d855a3cbbf67a6922e727fb400000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000931bea4bc76fad23ba9c339622dd" +
      "c0e7d28904a71353c715363aa9e038f64e990ef6ef76fc1fc431b9c73036dd07b86c00e1cb65fe1fe653f97f284ba8a8a7753cd6eb3e5cb9b630986974453ffaf71c00000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000a3caedb9c2a5d8e922359ef69f9c35b8c819bcb081610343148dc3a2c50255c9caa6090f49f890ca31d853384fc80d0000ba0779d2c83f133e65b603f3fb551c09808ec79b391c2ce795b99e7033647200000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000af3dc44695d2a7f45dbe8b21939d5b4015ed1697131184ce19fc6bb8ff6bbc23882348b4c86278282dddf7d718e72e2b00b4507bc731378119d5a6b0fde81a8c8d0f3b339d21dcff193e4c4423f44d1700000000000000000000000000000000ffffffffffffffffffffffffffffffff0000405973070000008aea7d8eb22063bcfe882e2b7efc0b3713e1a48dd8343bed523b1ab4546114be84d00f896d33c605d1f67456e8e2ed9300c594704570a94e9d73210200dc34c8881c562f90201de52c5b8c072d07880100000000000000000000000000000000ffffffffffffffffffffffffffffffff0000405973070000008fbdab59d6171f31107ff330af9f2c1a8078bb630abe379868670c61f8fa5f05a27c78f6a1fd80cde658417ef5d6a95100d0f83c9d63340e7457b9645a053914928048613e48706a8772561d538f09fe00000000000000000000000000000000ffffffffffffffffffffffffffffffff00004059730700000083798f4dcc27c08dcd23315bee084a9821f39eed4c35ef45ba5079de93e7cf49633eea6d0f30b20c252c941f615f6ccb00cfc312f8a7b23b314eeb52bb178b270d999438d117dc0956e339747baaf5aa00000000000000000000000000000000fffffffffffffffffffff" +
      "fffffffffff0000405973070000008f021f52cbd6c46979619100350a397154df00cae2efe72b22ad0dd66747d7de4beecd9b194d0f7016e4df460a63a8ea00d59862ebfa27c42fa3e8c0d1ca69d7a7bb4297cf89088ca3bdd51739ab30ed00000000000000000000000000000000ffffffffffffffffffffffffffffffff00004059730700000089db41a6183c2fe47cf54d1e00c3cfaae53df634a32cccd5cf0c0a73e95ee0450fc3d060bb6878780fbf5f30d9e29aac007a3b0c688ac515c6abb9e4639627dc4180312a85d48f8fb7c3151d46dbc15800000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000951f3707389db5012848b67ab77b63da2a73118b7df60f087fa9972d8f7fef33ed93e5f25268d4237c2987f032cd613f0083cd187a7634260d378628fa017a947b2f098f961a4956e999d181745719ff00000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000b57520f5150ed646e8c26a01bf0bd15a324cc66fa8903f33fa26c3b4dd16b9a7c5118fdac9ee3eceba5ff2138cdce8f00099411c4a76e6e1ef8c90d6edb2c241e96be4535d63a9622cdbbc49b0a11f2200000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000aa14e001d092db9dc99746fcfc22cd84a74adaa8fc483e6abf697bd8a93bda2ee9a075aca303f97f59615ed4e8709583004c13ca9798bcaf9309ed51c688c8630d1a45ec8ff9ebb923eeac85e0cb7cb600000000000000000000000000000000ffffffffffffffffffffffffffffffff00004059730700000098536b398e5b7f1276f7cb426fba0ec2b8b0b64fba7785ea528bebed6ae56c0dee59f5d295fa4c97a1c621ecacfc4ec300e5e6b82f0b9c5c1f029518512ed8dd07fd5f599d391eddb6de276650d9" +
      "e82e00000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000b783a70a1cf9f53e7d2ddf386bea81a947e5360c5f1e0bf004fceedb2073e4dd180ef3d2d91bee7b1c5a88d1afd11c49002706bf468ec15459aec57a7be9b7cca4dfa3096d9d6b2cbf2a3e3075bd9c4700000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000912b440c4d3c8177a012cea1cc58115cbc6795afc389363c7769bf419b9451bcde764586cf26c15e9906ea54837d031a00ec1c4314e39e99880a70d29eb920b01e02b0d87115bee14aa0f4906941927f00000000000000000000000000000000ffffffffffffffffffffffffffffffff0000405973070000008d8be92bde8af1b9df13d5a8ed8a3a01eab6ee4cf883d7987c1d78c0d7d9b53a8630541fddf5e324b6cf4900435b1df800d43a3a5e8086c72af954c40dff34489daceac483aa04547a3e370a4d88528600000000000000000000000000000000ffffffffffffffffffffffffffffffff00004059730700000086d386aaf3dff5b9331ace79f6e24cff8759e7e002bbe9af91c6de91ab693f6477551e7ee0a1e675d0fc614814d8a8aa00f379f060928290f4efd4bfb412816bf18be2d94ba097ccbdab18ffa1b672e000000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000911bb496153aa457e3302ea8e74427962c6eb57e97096f65cafe45a238f739b86d4b790debd5c7359f18f3642d7d774c0026fa5866b196557bacfbd02568bd5850bf48b4f2a1256ca219fab74e735e4100000000000000000000000000000000ffffffffffffffffffffffffffffffff000040597307000000004059730700000000405973070000000040597307000000004059730700000000405973070000000040597307000000004" +
      "0597307000000004059730700000000405973070000000040597307000000004059730700000000405973070000000040597307000000004059730700000000405973070000000040597307000000004059730700000000405973070000000040597307000000004059730700000000405973070000000040597307000000004059730700000000405973070000000040597307000000004059730700000000405973070000000040597307000000004059730700000000405973070000000040597307000000004059730700000000405973070000000040597307000000004059730700000000405973070000000040597307000000004059730700000000405973070000000040597307000000004059730700000000405973070000000040597307000000004059730700000000405973070000000040597307000000004059730700000000405973070000000040597307000000004059730700000000405973070000000040597307000000004059730700000000405973070000000040597307000000004059730700000000405973070000000040597307000000004059730700000000405973070000000040597307000000004059730700000000405973070000000040597307000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000000000000000000";

  @Test
  public void sszHashDoesntMatch() {
    SpecConstants specConstants = new SpecConstants() {
      @Override
      public ShardNumber getShardCount() {
        return ShardNumber.of(8);
      }

      @Override
      public EpochNumber getLatestRandaoMixesLength() {
        return EpochNumber.of(64);
      }

      @Override
      public EpochNumber getLatestActiveIndexRootsLength() {
        return EpochNumber.of(64);
      }

      @Override
      public EpochNumber getLatestSlashedExitLength() {
        return EpochNumber.of(64);
      }

      @Override
      public SlotNumber getSlotsPerHistoricalRoot() {
        return SlotNumber.of(64);
      }
    };
    SSZSerializer sszSerializer = new SSZBuilder()
        .withExternalVarResolver(new SpecConstantsResolver(specConstants))
        .addDefaultListAccessors()
        .addListAccessors(new ReadListAccessor()).buildSerializer();
    SSZObjectHasher incremental = SSZObjectHasher.create(specConstants, Hashes::sha256, true);
    SSZObjectHasher standard = SSZObjectHasher.create(specConstants, Hashes::sha256, false);
    MutableBeaconState decoded = sszSerializer.decode(BytesValue.fromHexString(state), BeaconStateImpl.class);
    PendingAttestation attestation = new PendingAttestation(
        Bitfield.of(BytesValue.fromHexString("0xff")),
        new AttestationData(
            Hash32.fromHexString("0xcf7bbca4dd6d846b48aad7c31f25e08c59e92260d0d0b2e3dc0d452ff4177c10"),
            EpochNumber.of(0),
            Hash32.ZERO,
            EpochNumber.of(1),
            Hash32.fromHexString("0xcf7bbca4dd6d846b48aad7c31f25e08c59e92260d0d0b2e3dc0d452ff4177c10"),
            ShardNumber.of(0),
            Hash32.fromHexString("0xdb56114e00fdd4c1f85c892bf35ac9a89289aaecb1ebd0a96cde606a748b5d71"),
            Hash32.ZERO
        ),
        SlotNumber.of(3),
        ValidatorIndex.of(2)
    );
    incremental.getHash(decoded); // get hash once
    decoded.getCurrentEpochAttestations().add(attestation);  // modify
    assertEquals(standard.getHash(decoded), incremental.getHash(decoded));  // get hash for the second time
  }
}
